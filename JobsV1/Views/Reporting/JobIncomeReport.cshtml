@{ 
  
}
<div id="joblisting-filter" class="row" style="background-color:#f3f3f3;padding:15px; box-shadow:0px 0px 5px 2px lightgray;min-width:700px; ">
    <div class="row col-lg-12">
        <div class="col-lg-3">
            <h5>Start Date</h5>
            <input type="date" class="form-control" value="@ViewBag.sDate" id="startDate" />
        </div>

        <div class="col-lg-3">
            <h5>End Date</h5>
            <input type="date" class="form-control" value="@ViewBag.eDate" id="endDate" />
        </div>

        <div class="col-lg-6" style="margin-top:-5px;">
            <h5>&nbsp;</h5>
            <button class="btn btn-default" id="datePrev30" onclick="setPrev30();"> 30 Days </button>
            <button class="btn btn-default" id="datePrev60" onclick="setPrev60();"> 60 Days </button>
        </div>
    </div>

    <div class="row col-lg-12">
        <div class="col-lg-3">
            <h5>Company</h5>
            <input type="text" value="@ViewBag.Id" id="company-input" class="form-control" />
        </div>

        <div class="col-lg-3">
            <h5>Unit/Driver</h5>
            <input type="text" value="@ViewBag.Id" id="unitDriverInput"  class="form-control"/>
        </div>

        <div class="col-lg-3" style="margin-top:10px;">
            <br />
            <button class="btn btn-primary" onclick="reportUpdate();">
                <span class="glyphicon glyphicon-search"></span> Filter
            </button>

            <button class="btn btn-primary" onclick="reportPrint();">
                <span class="glyphicon glyphicon-print"></span>  Print
            </button>
        </div>
    </div>
</div>

<div class="row" style="border: 1px solid lightgray; padding:20px;margin-top:15px; box-shadow:0px 0px 5px 2px lightgray;min-width:700px; ">

    @{Html.RenderAction("JobIncome");}

</div>
<script src="~/Scripts/DateRangePicker/moment.min.js"> </script>
<script src="~/Scripts/jquery-1.12.4.min.js"> </script>

<script>
    
    function Update() {
        var url_string = window.location.href;
        var url = new URL(url_string);
        var date1 = url.searchParams.get("sDate") != null ? url.searchParams.get("sDate") : getToday();
        var date2 = url.searchParams.get("eDate") != null ? url.searchParams.get("eDate") : getToday();

        var company = url.searchParams.get("company");
        var unitDriver = url.searchParams.get("unitDriver");

        $('#startDate').val(date1);
        $('#endDate').val(date2);
        $('#company-input').val(company);
        $('#unitDriverInput').val(unitDriver);
    }

    function setPrev30() {
        var today = new Date();
        var pastDate = new Date();

        pastDate = moment().add(-30, 'days').format('YYYY-MM-DD');
        today = moment().format('YYYY-MM-DD');

        $("#startDate").val(pastDate);
        $("#endDate").val(today);


    }

    function setPrev60() {
        var today = new Date();
        var pastDate = new Date();

        pastDate = moment().add(-60, 'days').format('YYYY-MM-DD');
        today = moment().format('YYYY-MM-DD');

        $("#startDate").val(pastDate);
        $("#endDate").val(today);
    }

    $(function () {
        Update();
    });

    Update();

    function getToday() {

        var today = moment().format('YYYY-MM-DD');
        return today;
    }

    function reportUpdate() {
        var CompanyVal = document.getElementById("company-input").value;
        var sDateVal = document.getElementById("startDate").value != "" ? document.getElementById("startDate").value : getToday();
        var eDateVal = document.getElementById("endDate").value != "" ? document.getElementById("endDate").value : getToday();
        var unitDriverVal = document.getElementById("unitDriverInput").value;

        var requestString = "/Reporting?";

        requestString += "reportkey=income&";

        if (eDateVal != null && sDateVal != null) {
            requestString = requestString + "sDate=" + sDateVal + "&eDate=" + eDateVal;
        }
        
        if(CompanyVal == "" ){
            CompanyVal = "all";
        } 
        requestString += "&company=" + CompanyVal;

        if (unitDriverVal == "") {
            unitDriverVal = "all";
        }
        requestString += "&unitDriver=" + unitDriverVal;

        window.location.href = requestString;
        //window.location.href = "/Reporting/Index/" + idVal + "&sDate=" + sDateVal + "&sDate=" + eDateVal;
    }

    function reportPrint() {
        var CompanyVal = document.getElementById("company-input").value;
        var sDateVal = document.getElementById("startDate").value != "" ? document.getElementById("startDate").value : getToday();
        var eDateVal = document.getElementById("endDate").value != "" ? document.getElementById("endDate").value : getToday();
        var unitDriverVal = document.getElementById("unitDriverInput").value;

        var requestString = "/Reporting/JobListingPrint?";

        if (eDateVal != null && sDateVal != null) {
            requestString = requestString + "sDate=" + sDateVal + "&eDate=" + eDateVal;
        }

        if (CompanyVal == "") {
            CompanyVal = "all";
        }
        requestString += "&company=" + CompanyVal;

        if (unitDriverVal == "") {
            unitDriverVal = "all";
        }
        requestString += "&unitDriver=" + unitDriverVal;

        window.location.href = requestString;
        //window.location.href = "/Reporting/Index/" + idVal + "&sDate=" + sDateVal + "&sDate=" + eDateVal;
    }

</script>
