@model IEnumerable<JobsV1.Controllers.cJobOrder>

@{
    ViewBag.Title = "Job Income Report";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<table>

    <tr>
        <td valign="top">
            <img src="~/Images/LOGO_AJRENTACAR.jpg" width="135" />
        </td>
        <td>
            <span style="font:bold 21px arial, verdana;">AJ88 Car Rental Services </span>
            <span style="font:12px arial, verdana;color:royalblue">
                <br />Door 1, Travelers Inn Bldg., Matina Pangi Rd., Matina Crossing, Davao City, 8000 
                <br />Tel# (+63)822971831; (+63)9167558473; (+63)9330895358
                <br />Email: ajdavao88@gmail.com; Website: http://www.AJDavaoCarRental.com/
                <br />TIN: 414-880-772-001 (non-Vat)
            </span>
        </td>
    </tr>
</table>
<div class="container">
    <div class="row" >

        <h3>
            Job Income Report :  
            
        </h3>
        <p>Date: <b>@ViewBag.sDate </b> to <b> @ViewBag.eDate </b></p> 
<table class="table table-bordered">

    <tr>
        <th>
            Job#
        </th>
        <th>
            Description
        </th>
        <th colspan="3">
            Amount
        </th>
        <th colspan="3">
            Income
        </th>
        <th>Status</th>
    </tr>

    <tr>
        <th colspan="2"></th>

        <th>Quoted</th>
        <th>Collected</th>
        <th>Expenses</th>

        <th>Tour</th>
        <th>Car</th>
        <th>Others</th>
        <th></th>

    </tr>


    @{
        decimal totalQuoted = 0;
        decimal totalCollected = 0;
        decimal totalExpenses = 0;
        decimal totalTourInc = 0;
        decimal totalCarInc = 0;
        decimal totalOtherInc = 0;

    }
    
    @if (Model.Count() == 0)
    {
        <tr>
            <td colspan="10" style="text-align:center;">
                <span>No Results Found</span>
            </td>
        </tr>
    }
    @foreach (var item in Model)
    {
        <tr>
            <td>                
                <!-- Id -->
                @item.Id
            </td>
            <td>
                <!--Desription-->
                <span style="color:black">
                    <span >
                        @item.Main.JobDate.ToShortDateString("MMM DD YYYY")  -
                    </span>
                    <span >
                        @item.Company
                    </span>
                    <span>/</span>
                    <span style="font-weight:bold;" >@item.Main.Customer.Name</span>

                    <span>-</span>
                    <span>
                        @item.Main.Description
                    </span>
                </span>
            </td>
            <!--Amount-->
            <td>
                @string.Format("{0:N0}", item.Main.AgreedAmt)
               
            </td>
            <td>
                @string.Format("{0:N0}", item.Payment)
                
            </td>
            <td>
                @string.Format("{0:N0}", item.Expenses)
                
            </td>

            <!--Income-->
            <td>
                @string.Format("{0:N0}", item.PostedIncome.Tour)
            </td>
            <td>
                @string.Format("{0:N0}", item.PostedIncome.Car)
            </td>
            <td>
                @string.Format("{0:N0}", item.PostedIncome.Others)
            </td>
            <td>
                @if (item.isPosted)
                {
                    <text>
                        Posted
                    </text>
                }
                else
                {
                    <text>
                <span class="list-inline">
                    <img src="~/Images/Erp/icons/icons-error.png" width="20" />
                    <span>Unposted</span>
                </span>
                    </text>
                }
            </td>
        </tr>

        totalQuoted += (decimal)item.Main.AgreedAmt;
        totalCollected += item.Payment;
        totalExpenses += item.Expenses;
        totalCarInc += item.PostedIncome.Car;
        totalTourInc += item.PostedIncome.Tour;
        totalOtherInc += item.PostedIncome.Others;
    }

    <tr>
        <th colspan="2"></th>

        <th>Quoted</th>
        <th>Collected</th>
        <th>Expenses</th>

        <th>Tour</th>
        <th>Car</th>
        <th>Others</th>
        <th></th>

    </tr>

    <tr style="font-weight:bold;background-color:#d8d8d8">
        <td colspan="2"><b>Total</b></td>

        <td>@string.Format("{0:N0}", totalQuoted)</td>
        <td>@string.Format("{0:N0}", totalCollected)</td>
        <td>@string.Format("{0:N0}", totalExpenses)</td>

        <td>@string.Format("{0:N0}", totalTourInc)</td>
        <td>@string.Format("{0:N0}", totalCarInc)</td>
        <td>@string.Format("{0:N0}", totalOtherInc)</td>
        <td></td>
    </tr>
    </table>
    </div>
</div>