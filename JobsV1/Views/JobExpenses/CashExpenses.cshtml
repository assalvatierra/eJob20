@model IEnumerable<JobsV1.Models.JobExpenses >

@{
    ViewBag.Title = "Expenses";
    Layout = "~/Views/Shared/_ModuleLayout.cshtml";
}

<h3>@ViewBag.JobOrderName </h3>

<p>
    Date: @ViewBag.jobDate.ToString("dd/MMM/yyyy")
    <br />Description: @ViewBag.jobDesc
    <br />@Html.ActionLink("Edit", "Edit", "JobMains", new { id = ViewBag.JobMainId }, null)
    | @Html.ActionLink("Details", "Details", "JobMains", new { id = ViewBag.JobMainId }, null)

</p>
         
<p>
    @Html.ActionLink("Services", "JobServices", "JobOrder", new { JobMainId = ViewBag.JobMainId }, null) |
    @Html.ActionLink("Itinerary", "JobItinerary", "JobItineraries", new { id = ViewBag.JobMainId }, null) |
    @Html.ActionLink("Notes", "JobNotes", "JobMains", new { id = ViewBag.JobMainId }, null) |
    @Html.ActionLink("Payments", "Payments", "JobPayments", new { id = ViewBag.JobMainId }, null) |
    Expenses
</p>



<h3> Agreed Amount : Php @ViewBag.jobAmount.ToString("#,###.00")  </h3>
<table class="table table-borderless" id="jobExpenseTbl">
    <tr>
        <th>
            Description
        </th>
        <th>
            Amount
        </th>
        <th>
            Remarks
        </th>
    </tr>


    <tr>
        <td>
            <b> Payment </b>
        </td>
        <td></td>
        <td></td>
    </tr>
    @foreach(var payments in ViewBag.PaymentRecord as IEnumerable<JobsV1.Models.JobPayment>)
    {

            <tr>
                <td>
                    &nbsp; &nbsp;
                    @payments.Bank.BankName
                </td>
                <td>
                    @payments.PaymentAmt.ToString("#,###.00")
                </td>
                <td>
                    @payments.Remarks
                </td>
            </tr>
        
    }

    <tr style="font-weight:bold;">
        <td>Total: </td>
        <td colspan="2">@ViewBag.totalPayment.ToString("#,###.00") </td>
    </tr>

    <tr><td colspan="3"></td></tr>
     <tr>
         <td><b>
                Expenses
            </b>
         </td>
         <td colspan="3">

         </td>
     </tr>
        @foreach (var services in ViewBag.jobservices as IEnumerable<JobsV1.Models.JobServices>)
        {
            <tr>
                <td colspan="4"> &nbsp; &nbsp;
                   @services.Particulars ( @services.ActualAmt )
                   | @Html.ActionLink("Add Expense", "JobExpenses", "JobExpenses", new { id = services.Id }, null)
                </td>
            </tr>
            foreach (var item in Model)
            {
                if (item.JobServicesId == services.Id)
                {

                <tr style="color:#28598f">
                    <td>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;
                        @item.Expens.Name
                    </td>
                    <td>
                        @item.Amount.ToString("#,###.00")
                    </td>
                    <td>
                        @item.Remarks
                    </td>
                </tr>

                }
            }
        }

    <tr style="font-weight:bold;">
        <td>Total: </td>
        <td colspan="2">@ViewBag.totalExpenses.ToString("#,###.00") </td>
    </tr>
</table>

<hr />
<h3>Income</h3>
<table class="table table-borderless">
    <tr>
        <th>Car Rental</th>
        <th>Tour</th>
        <th>Others</th>
    </tr>
    <tr>
        <td>@ViewBag.carRentalIncome.ToString("#,###.00")</td>
        <td>@ViewBag.tourIncome.ToString("#,###.00")</td>
        <td>@ViewBag.othersIncome.ToString("#,###.00")</td>
    </tr>
</table>

<div class="jumbotron">
    <div class="container">
        
            <h3>Summary</h3>
            <h3> Payments:  @ViewBag.totalPayment.ToString("#,###.00") </h3>
            <h3> Expenses:  @ViewBag.totalExpenses.ToString("#,###.00") </h3>
            <h3> Total: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; @ViewBag.totalBalance.ToString("#,###.00") </h3>
         
                <button class="btn btn-primary"><b> Post and Close Job </b></button>
           
    </div>
</div>

